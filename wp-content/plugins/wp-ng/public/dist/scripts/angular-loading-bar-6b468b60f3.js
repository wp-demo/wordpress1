!function(){"use strict";angular.module("angular-loading-bar",["cfp.loadingBarInterceptor"]),angular.module("chieffancypants.loadingBar",["cfp.loadingBarInterceptor"]),angular.module("cfp.loadingBarInterceptor",["cfp.loadingBar"]).config(["$httpProvider",function(h){var e=["$q","$cacheFactory","$timeout","$rootScope","$log","cfpLoadingBar",function(n,i,t,a,r,c){var o,l=0,d=0,s=c.latencyThreshold;function u(){t.cancel(o),c.complete(),l=d=0}function g(e){var n,t=i.get("$http"),a=h.defaults;!e.cache&&!a.cache||!1===e.cache||"GET"!==e.method&&"JSONP"!==e.method||(n=angular.isObject(e.cache)?e.cache:angular.isObject(a.cache)?a.cache:t);var r=void 0!==n&&void 0!==n.get(e.url);return void 0!==e.cached&&r!==e.cached?e.cached:e.cached=r}return{request:function(e){return e.ignoreLoadingBar||g(e)||(a.$broadcast("cfpLoadingBar:loading",{url:e.url}),0===l&&(o=t(function(){c.start()},s)),l++,c.set(d/l)),e},response:function(e){return e&&e.config?e.config.ignoreLoadingBar||g(e.config)||(d++,a.$broadcast("cfpLoadingBar:loaded",{url:e.config.url,result:e}),l<=d?u():c.set(d/l)):r.error("Broken interceptor detected: Config object not supplied in response:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),e},responseError:function(e){return e&&e.config?e.config.ignoreLoadingBar||g(e.config)||(d++,a.$broadcast("cfpLoadingBar:loaded",{url:e.config.url,result:e}),l<=d?u():c.set(d/l)):r.error("Broken interceptor detected: Config object not supplied in rejection:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),n.reject(e)}}}];h.interceptors.push(e)}]),angular.module("cfp.loadingBar",[]).provider("cfpLoadingBar",function(){this.autoIncrement=!0,this.includeSpinner=!0,this.includeBar=!0,this.latencyThreshold=100,this.startSize=.02,this.parentSelector="body",this.spinnerTemplate='<div id="loading-bar-spinner"><div class="spinner-icon"></div></div>',this.loadingBarTemplate='<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>',this.$get=["$injector","$document","$timeout","$rootScope",function(r,i,c,o){var l,t,d,s=this.parentSelector,u=angular.element(this.loadingBarTemplate),a=u.find("div").eq(0),g=angular.element(this.spinnerTemplate),h=!1,p=0,f=this.autoIncrement,m=this.includeSpinner,v=this.includeBar,B=this.startSize;function b(e){if(h){var n=100*e+"%";a.css("width",n),p=e,f&&(c.cancel(t),t=c(function(){$()},250))}}function $(){if(!(1<=S())){var e=0,n=S();e=0<=n&&n<.25?(3*Math.random()+3)/100:.25<=n&&n<.65?3*Math.random()/100:.65<=n&&n<.9?2*Math.random()/100:.9<=n&&n<.99?.005:0,b(S()+e)}}function S(){return p}function n(){p=0,h=!1}return{start:function(){if(l||(l=r.get("$animate")),c.cancel(d),!h){var e=i[0],n=e.querySelector?e.querySelector(s):i.find(s)[0];n||(n=e.getElementsByTagName("body")[0]);var t=angular.element(n),a=n.lastChild&&angular.element(n.lastChild);o.$broadcast("cfpLoadingBar:started"),h=!0,v&&l.enter(u,t,a),m&&l.enter(g,t,u),b(B)}},set:b,status:S,inc:$,complete:function(){l||(l=r.get("$animate")),o.$broadcast("cfpLoadingBar:completed"),b(1),c.cancel(d),d=c(function(){var e=l.leave(u,n);e&&e.then&&e.then(n),l.leave(g)},500)},autoIncrement:this.autoIncrement,includeSpinner:this.includeSpinner,latencyThreshold:this.latencyThreshold,parentSelector:this.parentSelector,startSize:this.startSize}}]})}();