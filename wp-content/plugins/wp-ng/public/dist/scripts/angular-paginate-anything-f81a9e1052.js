!function(){"use strict";function g(e){return Math.floor(Math.pow(10,Math.floor(e/3))*[1,2.5,5][e%3])}function l(e){if(e<1)return 0;var a=Math.floor(Math.log(e)/Math.LN10),t=e/(2.5*Math.pow(10,a));return 3<=t&&(a++,t=0),3*a+Math.round(Math.min(2,t))}function u(e){return e===1/0?1/0:g(l(e))}function p(e){return e.to-e.from+1}angular.module("bgf.paginateAnything",[]).directive("bgfPagination",function(){return{restrict:"AE",scope:{url:"=",collection:"=",urlParams:"=?",headers:"=?",page:"=?",perPage:"=?",perPagePresets:"=?",autoPresets:"=?",clientLimit:"=?",linkGroupSize:"=?",reloadPage:"=?",size:"=?",passive:"@",transformResponse:"=?",method:"@",postData:"=?",loadFn:"&",numPages:"=?",numItems:"=?",serverLimit:"=?",rangeFrom:"=?",rangeTo:"=?"},templateUrl:function(e,a){return a.templateUrl||"src/paginate-anything.html"},replace:!0,controller:["$scope","$attrs","$http",function(o,e,r){o.reloadPage=!1,o.serverLimit=1/0,o.Math=window.Math;var n=void 0!==e.loadFn;"boolean"!=typeof o.autoPresets&&(o.autoPresets=!0);var a=o.linkGroupSize,t=o.clientLimit;function i(i){if("true"!==o.passive&&(o.url||n)){o.$emit("pagination:loadStart",i);var e,a,t={method:o.method||"GET",url:o.url,params:o.urlParams,data:o.postData,headers:angular.extend({},o.headers,{"Range-Unit":"items",Range:[i.from,i.to].join("-")}),transformResponse:(e=r.defaults.transformResponse,a=o.transformResponse,e=angular.isArray(e)?e:[e],a?e.concat(a):e)};(n?o.loadFn({config:t}):r(t)).then(function(e){var a,t,r=(a=e.headers("Content-Range"),(t=a&&a.match(/^(?:items )?(\d+)-(\d+)\/(\d+|\*)$/))?{from:+t[1],to:+t[2],total:"*"===t[3]?1/0:+t[3]}:"*/0"===a?{total:0}:null);if(204===e.status||r&&0===r.total?(o.numItems=0,o.collection=[]):(o.numItems=r?r.total:e.data.length,o.collection=e.data||[]),r&&(o.rangeFrom=r.from,o.rangeTo=r.to,p(r)<r.total&&(i.to<r.total-1||r.to<r.total-1&&r.total<i.to)&&(!o.perPage||p(r)<o.perPage))){if(o.autoPresets){var n=l(p(r));g(n)>p(r)&&n--,o.serverLimit=g(n)}else o.serverLimit=p(r);o.perPage=o.Math.min(o.serverLimit,o.clientLimit)}o.numPages=Math.ceil(o.numItems/(o.perPage||50)),o.$emit("pagination:loadPage",e.status,e.config)},function(e){o.$emit("pagination:error",e.status,e.config)})}}o.linkGroupSize="number"==typeof a?a:3,o.clientLimit="number"==typeof t?t:250,o.updatePresets=function(){if(o.autoPresets){var e,a=[];for(e=Math.min(3,l(o.perPage||50));e<=l(Math.min(o.clientLimit,o.serverLimit));e++)a.push(g(e));o.perPagePresets=a}else o.perPagePresets=o.perPagePresets.filter(function(e){return e<=o.serverLimit}).concat([o.serverLimit])},o.gotoPage=function(e){e<0||e*o.perPage>=o.numItems||(o.page=e)},o.linkGroupFirst=function(){var e=Math.max(0,o.linkGroupSize-(o.numPages-1-(o.page+2)));return Math.max(0,o.page-(o.linkGroupSize+e))},o.linkGroupLast=function(){var e=Math.max(0,o.linkGroupSize-(o.page-2));return Math.min(o.numPages-1,o.page+(o.linkGroupSize+e))},o.isFinite=function(){return o.numPages<1/0},o.page=o.page||0,o.size=o.size||"md",o.autoPresets&&o.updatePresets(),o.$watch("page",function(e,a){if("true"!==o.passive&&e!==a){if(e<0||e*o.perPage>=o.numItems)return;var t=o.perPage||50;o.autoPresets&&(t=u(t)),i({from:e*t,to:(e+1)*t-1})}}),o.$watch("perPage",function(e,a){if("true"!==o.passive&&"number"==typeof a&&e!==a){var t=o.page*a,r=Math.floor(t/e);o.page!==r?o.page=r:i({from:o.page*e,to:(o.page+1)*e-1})}}),o.$watch("serverLimit",function(e,a){"true"!==o.passive&&e!==a&&o.updatePresets()}),o.$watch("url",function(e,a){"true"!==o.passive&&e!==a&&(0===o.page?o.reloadPage=!0:o.page=0)}),o.$watch("urlParams",function(e,a){"true"!==o.passive&&(angular.equals(e,a)||(0===o.page?o.reloadPage=!0:o.page=0))},!0),o.$watch("headers",function(e,a){"true"!==o.passive&&(angular.equals(e,a)||(0===o.page?o.reloadPage=!0:o.page=0))},!0),o.$watch("reloadPage",function(e,a){if("true"!==o.passive&&!0===e&&!1===a){var t=o.perPage||50;o.reloadPage=!1,i({from:o.page*t,to:(o.page+1)*t-1})}}),o.$watch("transformResponse",function(e,a){"true"!==o.passive&&e&&a&&(angular.equals(e.toString(),a.toString())||(0===o.page?o.reloadPage=!0:o.page=0))},!0),o.$on("pagination:reload",function(){o.reloadPage=!0});var s=o.perPage||50;o.autoPresets&&(s=u(s)),i({from:o.page*s,to:(o.page+1)*s-1})}]}}).filter("makeRange",function(){return function(e){var a,t;switch(e.length){case 1:a=0,t=parseInt(e[0],10)-1;break;case 2:a=parseInt(e[0],10),t=parseInt(e[1],10);break;default:return e}for(var r=[],n=a;n<=t;n++)r.push(n);return r}})}(),angular.module("bgf.paginateAnything").run(["$templateCache",function(e){"use strict";e.put("src/paginate-anything.html",'<div class=paginate-anything><ul class="pagination pagination-{{size}} links" ng-if="numPages > 1"><li ng-class="{disabled: page <= 0}"><a href ng-click=gotoPage(page-1)>&laquo;</a></li><li ng-if="linkGroupFirst() > 0"><a href ng-click=gotoPage(0)>1</a></li><li ng-if="linkGroupFirst() > 1" class=disabled><a href>&hellip;</a></li><li ng-repeat="p in [linkGroupFirst(), linkGroupLast()] | makeRange" ng-class="{active: p === page}"><a href ng-click=gotoPage(p)>{{p+1}}</a></li><li ng-if="linkGroupLast() < numPages - 2" class=disabled><a href>&hellip;</a></li><li ng-if="isFinite() && linkGroupLast() < numPages - 1"><a href ng-click=gotoPage(numPages-1)>{{numPages}}</a></li><li ng-class="{disabled: page >= numPages - 1}"><a href ng-click=gotoPage(page+1)>&raquo;</a></li></ul><div class=per-page ng-if="perPagePresets.length > 0 && numPages > 1"><select ng-model=$parent.perPage ng-options="p for p in perPagePresets"></select>per page</div></div>')}]);