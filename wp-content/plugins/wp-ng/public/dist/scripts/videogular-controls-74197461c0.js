"use strict";angular.module("com.2fdevs.videogular.plugins.controls",[]).run(["$templateCache",function(e){e.put("vg-templates/vg-controls",'<div class="controls-container" ng-mousemove="onMouseMove()" ng-class="animationClass" ng-transclude></div>')}]).directive("vgControls",["$timeout","VG_STATES",function(a,r){return{restrict:"E",require:"^videogular",transclude:!0,templateUrl:function(e,t){return t.vgTemplate||"vg-templates/vg-controls"},scope:{vgAutohide:"=?",vgAutohideTime:"=?"},link:function(n,e,t,o){var u,i=2e3;n.API=o,n.onMouseMove=function(){n.vgAutohide&&n.showControls()},n.setAutohide=function(e){e&&o.currentState===r.PLAY?u=a(n.hideControls,i):(n.animationClass="",a.cancel(u),n.showControls())},n.setAutohideTime=function(e){i=e},n.hideControls=function(){n.animationClass="hide-animation"},n.showControls=function(){n.animationClass="show-animation",a.cancel(u),n.vgAutohide&&o.currentState===r.PLAY&&(u=a(n.hideControls,i))},o.isConfig?n.$watch("API.config",function(){if(n.API.config){var e=n.API.config.plugins.controls.autohide||!1,t=n.API.config.plugins.controls.autohideTime||2e3;n.vgAutohide=e,n.vgAutohideTime=t,n.setAutohideTime(t),n.setAutohide(e)}}):(void 0!==n.vgAutohide&&n.$watch("vgAutohide",n.setAutohide),void 0!==n.vgAutohideTime&&n.$watch("vgAutohideTime",n.setAutohideTime)),n.$watch(function(){return o.currentState},function(e,t){n.vgAutohide&&n.showControls()})}}}]),angular.module("com.2fdevs.videogular.plugins.controls").run(["$templateCache",function(e){e.put("vg-templates/vg-fullscreen-button",'<button class="iconButton" ng-click="onClickFullScreen()" ng-class="fullscreenIcon" aria-label="Toggle full screen" type="button"> </button>')}]).directive("vgFullscreenButton",[function(){return{restrict:"E",require:"^videogular",scope:{},templateUrl:function(e,t){return t.vgTemplate||"vg-templates/vg-fullscreen-button"},link:function(n,e,t,o){n.onChangeFullScreen=function(e){n.fullscreenIcon={enter:!e,exit:e}},n.onClickFullScreen=function(){o.toggleFullScreen()},n.fullscreenIcon={enter:!0},n.$watch(function(){return o.isFullScreen},function(e,t){e!==t&&n.onChangeFullScreen(e)})}}}]),angular.module("com.2fdevs.videogular.plugins.controls").run(["$templateCache",function(e){e.put("vg-templates/vg-play-pause-button",'<button class="iconButton" ng-click="onClickPlayPause()" ng-class="playPauseIcon" aria-label="Play/Pause" type="button"></button>')}]).directive("vgPlayPauseButton",["VG_STATES",function(u){return{restrict:"E",require:"^videogular",scope:{},templateUrl:function(e,t){return t.vgTemplate||"vg-templates/vg-play-pause-button"},link:function(n,e,t,o){n.setState=function(e){switch(e){case u.PLAY:n.playPauseIcon={pause:!0};break;case u.PAUSE:case u.STOP:n.playPauseIcon={play:!0}}},n.onClickPlayPause=function(){o.playPause()},n.playPauseIcon={play:!0},n.$watch(function(){return o.currentState},function(e,t){n.setState(e)})}}}]),angular.module("com.2fdevs.videogular.plugins.controls").run(["$templateCache",function(e){e.put("vg-templates/vg-playback-button",'<button class="playbackValue iconButton" ng-click="onClickPlayback()">{{playback}}x</button>')}]).directive("vgPlaybackButton",[function(){return{restrict:"E",require:"^videogular",templateUrl:function(e,t){return t.vgTemplate||"vg-templates/vg-playback-button"},scope:{vgSpeeds:"=?"},link:function(n,e,t,o){n.playback="1",n.setPlayback=function(e){n.playback=e,o.setPlayback(parseFloat(e))},n.onClickPlayback=function(){var e=n.vgSpeeds||["0.5","1","1.5","2"],t=e.indexOf(n.playback.toString())+1;t>=e.length?n.playback=e[0]:n.playback=e[t],n.setPlayback(n.playback)},n.$watch(function(){return o.playback},function(e,t){e!==t&&n.setPlayback(e)})}}}]),angular.module("com.2fdevs.videogular.plugins.controls").directive("vgScrubBarBuffer",[function(){return{restrict:"E",require:"^videogular",link:function(n,t,e,o){var u=0;n.onUpdateBuffer=function(e){"number"==typeof e&&o.totalTime?(u=e/o.totalTime*100,t.css("width",u+"%")):t.css("width",0)},n.$watch(function(){return o.bufferEnd},function(e,t){n.onUpdateBuffer(e)})}}}]),angular.module("com.2fdevs.videogular.plugins.controls").run(["$templateCache",function(e){e.put("vg-templates/vg-scrub-bar-cue-points",'<div class="cue-point-timeline"><div ng-repeat="cuePoint in vgCuePoints" class="cue-point" ng-style="cuePoint.$$style"></div></div>')}]).directive("vgScrubBarCuePoints",[function(){return{restrict:"E",require:"^videogular",templateUrl:function(e,t){return t.vgTemplate||"vg-templates/vg-scrub-bar-cue-points"},scope:{vgCuePoints:"="},link:function(n,a,e,r){n.onPlayerReady=function(){n.updateCuePoints(n.vgCuePoints)},n.updateCuePoints=function(e){if(e){parseInt(a[0].clientWidth);for(var t=0,n=e.length;t<n;t++){var o=1e3*((0<=e[t].timeLapse.end?e[t].timeLapse.end:e[t].timeLapse.start+1)-e[t].timeLapse.start),u=100*e[t].timeLapse.start/Math.round(r.totalTime/1e3)+"%",i=0;"number"==typeof o&&r.totalTime&&(i=100*o/r.totalTime+"%"),e[t].$$style={width:i,left:u}}}},n.$watch("vgCuePoints",n.updateCuePoints),n.$watch(function(){return r.totalTime},function(e,t){0<e&&n.onPlayerReady()})}}}]),angular.module("com.2fdevs.videogular.plugins.controls").directive("vgScrubBarCurrentTime",[function(){return{restrict:"E",require:"^videogular",link:function(n,t,e,o){var u=0;n.onUpdateTime=function(e){"number"==typeof e&&o.totalTime?(u=e/o.totalTime*100,t.css("width",u+"%")):t.css("width",0)},n.$watch(function(){return o.currentTime},function(e,t){n.onUpdateTime(e)})}}}]),angular.module("com.2fdevs.videogular.plugins.controls").run(["$templateCache",function(e){e.put("vg-templates/vg-scrub-bar-thumbnails",'<div class="vg-thumbnails" ng-show="thumbnails" ng-style="thumbnailContainer"><div class="image-thumbnail" ng-style="thumbnails"></div></div><div class="background"></div>')}]).directive("vgScrubBarThumbnails",["VG_UTILS",function(o){return{restrict:"E",require:"^videogular",templateUrl:function(e,t){return t.vgTemplate||"vg-templates/vg-scrub-bar-thumbnails"},scope:{vgThumbnails:"="},link:function(c,e,t,s){var n,m=0,v=0,d=e[0].querySelector(".background"),f="string"==typeof c.vgThumbnails;c.thumbnails=!1,c.thumbnailContainer={},c.getOffset=function(e){for(var t=e.target,n=0;t&&!isNaN(t.offsetLeft);)n+=t.offsetLeft-t.scrollLeft,t=t.offsetParent;return e.clientX-n},c.onLoadThumbnails=function(e){m=e.currentTarget.naturalWidth,v=m/100},c.onLoadThumbnail=function(e){v=e.currentTarget.naturalWidth},c.updateThumbnails=function(e){var t=Math.round(100*e/(s.totalTime/1e3)),n=d.scrollWidth*t/100-v/2;if(f){var o=Math.round(m*t/100);c.thumbnailContainer={width:v+"px",left:n+"px"},c.thumbnails={"background-image":'url("'+c.vgThumbnails+'")',"background-position":-o+"px 0px"}}else{var u=s.totalTime/d.scrollWidth/1e3,i={start:Math.floor(e-u/2),end:Math.ceil(e)};if(i.start<0&&(i.start=0),i.end>s.totalTime&&(i.end=s.totalTime),c.thumbnailContainer={left:n+"px"},c.thumbnails={"background-image":"none"},c.vgThumbnails)for(var a=0,r=c.vgThumbnails.length;a<r;a++){var l=c.vgThumbnails[a];if(0<=l.timeLapse.end){if(i.start>=l.timeLapse.start&&(i.end<=l.timeLapse.end||i.end<=l.timeLapse.start)){c.thumbnails={"background-image":'url("'+l.params.thumbnail+'")'};break}}else if(l.timeLapse.start>=i.start&&l.timeLapse.start<=i.end){c.thumbnails={"background-image":'url("'+l.params.thumbnail+'")'};break}}}},c.onMouseMove=function(e){var t=Math.round(e.offsetX*s.mediaElement[0].duration/d.scrollWidth);c.updateThumbnails(t),c.$digest()},c.onTouchMove=function(e){var t=e.touches,n=c.getOffset(t[0]),o=Math.round(n*s.mediaElement[0].duration/d.scrollWidth);c.updateThumbnails(o),c.$digest()},c.onMouseLeave=function(e){c.thumbnails=!1,c.$digest()},c.onTouchLeave=function(e){c.thumbnails=!1,c.$digest()},c.onDestroy=function(){e.unbind("touchmove",c.onTouchMove),e.unbind("touchleave",c.onTouchLeave),e.unbind("touchend",c.onTouchLeave),e.unbind("mousemove",c.onMouseMove),e.unbind("mouseleave",c.onMouseLeave)},n.src=f?((n=new Image).onload=c.onLoadThumbnails.bind(c),c.vgThumbnails):((n=new Image).onload=c.onLoadThumbnail.bind(c),c.vgThumbnails[0].params.thumbnail),o.isMobileDevice()?(e.bind("touchmove",c.onTouchMove),e.bind("touchleave",c.onTouchLeave),e.bind("touchend",c.onTouchLeave)):(e.bind("mousemove",c.onMouseMove),e.bind("mouseleave",c.onMouseLeave)),c.$on("destroy",c.onDestroy.bind(c))}}}]),angular.module("com.2fdevs.videogular.plugins.controls").run(["$templateCache",function(e){e.put("vg-templates/vg-scrub-bar",'<div role="slider" aria-valuemax="{{ariaTime(API.totalTime)}}" aria-valuenow="{{ariaTime(API.currentTime)}}" aria-valuemin="0" aria-label="Time scrub bar" tabindex="0" ng-keydown="onScrubBarKeyDown($event)"></div><div class="container" ng-transclude></div>')}]).directive("vgScrubBar",["VG_STATES","VG_UTILS",function(m,v){return{restrict:"E",require:"^videogular",transclude:!0,templateUrl:function(e,t){return t.vgTemplate||"vg-templates/vg-scrub-bar"},scope:{vgThumbnails:"="},link:function(i,e,t,a){var r=!1,o=!1,u=!1,l=0,c=0,s=e[0].querySelector("div[role=slider]");if(i.thumbnails=!1,i.thumbnailContainer={},i.API=a,i.onLoadThumbnails=function(e){l=e.path[0].naturalWidth,c=l/100},i.ariaTime=function(e){return Math.round(e/1e3)},i.getOffset=function(e){for(var t=e.target,n=0;t&&!isNaN(t.offsetLeft);)n+=t.offsetLeft-t.scrollLeft,t=t.offsetParent;return e.clientX-n},i.onScrubBarTouchStart=function(e){var t=(e.originalEvent||e).touches,n=i.getOffset(t[0]);r=!0,o&&(u=!0),a.pause(),a.seekTime(n*a.mediaElement[0].duration/s.scrollWidth),i.$digest()},i.onScrubBarTouchEnd=function(e){e.originalEvent;u&&(u=!1,a.play()),r=!1,i.$digest()},i.onScrubBarTouchMove=function(e){var t=(e.originalEvent||e).touches,n=i.getOffset(t[0]);if(i.vgThumbnails&&i.vgThumbnails.length){var o=Math.round(n*a.mediaElement[0].duration/s.scrollWidth),u=Math.round(100*o/(a.totalTime/1e3));i.updateThumbnails(u)}r&&a.seekTime(n*a.mediaElement[0].duration/s.scrollWidth),i.$digest()},i.onScrubBarTouchLeave=function(e){r=!1,i.thumbnails=!1,i.$digest()},i.onScrubBarMouseDown=function(e){e=v.fixEventOffset(e),r=!0,o&&(u=!0),a.pause(),a.seekTime(e.offsetX*a.mediaElement[0].duration/s.scrollWidth),i.$digest()},i.onScrubBarMouseUp=function(e){u&&(u=!1,a.play()),r=!1,i.$digest()},i.onScrubBarMouseMove=function(e){if(i.vgThumbnails&&i.vgThumbnails.length){var t=Math.round(e.offsetX*a.mediaElement[0].duration/s.scrollWidth),n=Math.round(100*t/(a.totalTime/1e3));i.updateThumbnails(n)}r&&(e=v.fixEventOffset(e),a.seekTime(e.offsetX*a.mediaElement[0].duration/s.scrollWidth)),i.$digest()},i.onScrubBarMouseLeave=function(e){r=!1,i.thumbnails=!1,i.$digest()},i.onScrubBarKeyDown=function(e){var t=a.currentTime/a.totalTime*100;37===e.which||37===e.keyCode?(a.seekTime(t-5,!0),e.preventDefault()):39!==e.which&&39!==e.keyCode||(a.seekTime(t+5,!0),e.preventDefault())},i.updateThumbnails=function(e){var t=Math.round(l*e/100),n=s.scrollWidth*e/100-c/2;i.thumbnailContainer={width:c+"px",left:n+"px"},i.thumbnails={"background-image":'url("'+i.vgThumbnails+'")',"background-position":-t+"px 0px"}},i.setState=function(e){if(!r)switch(e){case m.PLAY:o=!0;break;case m.PAUSE:case m.STOP:o=!1}},i.onDestroy=function(){e.unbind("touchstart",i.onScrubBarTouchStart),e.unbind("touchend",i.onScrubBarTouchEnd),e.unbind("touchmove",i.onScrubBarTouchMove),e.unbind("touchleave",i.onScrubBarTouchLeave),e.unbind("mousedown",i.onScrubBarMouseDown),e.unbind("mouseup",i.onScrubBarMouseUp),e.unbind("mousemove",i.onScrubBarMouseMove),e.unbind("mouseleave",i.onScrubBarMouseLeave)},i.$watch(function(){return a.currentState},function(e,t){e!==t&&i.setState(e)}),i.vgThumbnails){var n=new Image;n.onload=i.onLoadThumbnails.bind(i),n.src=i.vgThumbnails}v.isMobileDevice()?(e.bind("touchstart",i.onScrubBarTouchStart),e.bind("touchend",i.onScrubBarTouchEnd),e.bind("touchmove",i.onScrubBarTouchMove),e.bind("touchleave",i.onScrubBarTouchLeave)):(e.bind("mousedown",i.onScrubBarMouseDown),e.bind("mouseup",i.onScrubBarMouseUp),e.bind("mousemove",i.onScrubBarMouseMove),e.bind("mouseleave",i.onScrubBarMouseLeave)),i.$on("destroy",i.onDestroy.bind(i))}}}]),angular.module("com.2fdevs.videogular.plugins.controls").directive("vgTimeDisplay",[function(){return{require:"^videogular",restrict:"E",link:function(n,e,t,o){n.currentTime=o.currentTime,n.timeLeft=o.timeLeft,n.totalTime=o.totalTime,n.isLive=o.isLive,n.$watch(function(){return o.currentTime},function(e,t){n.currentTime=e}),n.$watch(function(){return o.timeLeft},function(e,t){n.timeLeft=e}),n.$watch(function(){return o.totalTime},function(e,t){n.totalTime=e}),n.$watch(function(){return o.isLive},function(e,t){n.isLive=e})}}}]),angular.module("com.2fdevs.videogular.plugins.controls").run(["$templateCache",function(e){e.put("vg-templates/vg-mute-button",'<button type="button" class="iconButton" ng-class="muteIcon" ng-click="onClickMute()" ng-focus="onMuteButtonFocus()" ng-blur="onMuteButtonLoseFocus()" ng-mouseleave="onMuteButtonLeave()" ng-keydown="onMuteButtonKeyDown($event)" aria-label="Mute"></button>')}]).directive("vgMuteButton",[function(){return{restrict:"E",require:"^videogular",templateUrl:function(e,t){return t.vgTemplate||"vg-templates/vg-mute-button"},link:function(n,e,t,o){var u=!1;n.onClickMute=function(){u?n.currentVolume=n.defaultVolume:(n.currentVolume=0,n.muteIcon={mute:!0}),u=!u,o.setVolume(n.currentVolume)},n.onMuteButtonFocus=function(){n.volumeVisibility="visible"},n.onMuteButtonLoseFocus=function(){n.volumeVisibility="hidden"},n.onMuteButtonLeave=function(){document.activeElement.blur()},n.onMuteButtonKeyDown=function(e){var t,n=null!==o.volume?o.volume:1;38===e.which||38===e.keyCode?(1<(t=n+.05)&&(t=1),o.setVolume(t),e.preventDefault()):40!==e.which&&40!==e.keyCode||((t=n-.05)<0&&(t=0),o.setVolume(t),e.preventDefault())},n.onSetVolume=function(e){n.currentVolume=e,(u=0===n.currentVolume)?0<e&&(n.defaultVolume=e):n.defaultVolume=e;var t=Math.round(100*e);0===t?n.muteIcon={mute:!0}:0<t&&t<25?n.muteIcon={level0:!0}:25<=t&&t<50?n.muteIcon={level1:!0}:50<=t&&t<75?n.muteIcon={level2:!0}:75<=t&&(n.muteIcon={level3:!0})},n.defaultVolume=1,n.currentVolume=n.defaultVolume,n.muteIcon={level3:!0},n.onSetVolume(o.volume),n.$watch(function(){return o.volume},function(e,t){e!==t&&n.onSetVolume(e)})}}}]),angular.module("com.2fdevs.videogular.plugins.controls").run(["$templateCache",function(e){e.put("vg-templates/vg-volume-bar",'<div class="verticalVolumeBar"><div class="volumeBackground" ng-click="onClickVolume($event)" ng-mousedown="onMouseDownVolume()" ng-mouseup="onMouseUpVolume()" ng-mousemove="onMouseMoveVolume($event)" ng-mouseleave="onMouseLeaveVolume()"><div class="volumeValue"></div><div class="volumeClickArea"></div></div></div>')}]).directive("vgVolumeBar",["VG_UTILS",function(r){return{restrict:"E",require:"^videogular",templateUrl:function(e,t){return t.vgTemplate||"vg-templates/vg-volume-bar"},link:function(n,t,e,o){var u=!1,i=angular.element(t[0].getElementsByClassName("volumeBackground")),a=angular.element(t[0].getElementsByClassName("volumeValue"));n.onClickVolume=function(e){e=r.fixEventOffset(e);var t=parseInt(i.prop("offsetHeight")),n=1-100*e.offsetY/t/100;o.setVolume(n)},n.onMouseDownVolume=function(){u=!0},n.onMouseUpVolume=function(){u=!1},n.onMouseLeaveVolume=function(){u=!1},n.onMouseMoveVolume=function(e){if(u){e=r.fixEventOffset(e);var t=parseInt(i.prop("offsetHeight")),n=1-100*e.offsetY/t/100;o.setVolume(n)}},n.updateVolumeView=function(e){e*=100,a.css("height",e+"%"),a.css("top",100-e+"%")},n.onChangeVisibility=function(e){t.css("visibility",e)},t.css("visibility",n.volumeVisibility),n.$watch("volumeVisibility",n.onChangeVisibility),n.updateVolumeView(o.volume),n.$watch(function(){return o.volume},function(e,t){e!==t&&n.updateVolumeView(e)})}}}]),angular.module("com.2fdevs.videogular.plugins.controls").directive("vgVolume",["VG_UTILS",function(o){return{restrict:"E",link:function(e,t,n){e.onMouseOverVolume=function(){e.$evalAsync(function(){e.volumeVisibility="visible"})},e.onMouseLeaveVolume=function(){e.$evalAsync(function(){e.volumeVisibility="hidden"})},e.onDestroy=function(){t.unbind("mouseover",e.onScrubBarTouchStart),t.unbind("mouseleave",e.onScrubBarTouchEnd)},o.isMobileDevice()?t.css("display","none"):(e.volumeVisibility="hidden",t.bind("mouseover",e.onMouseOverVolume),t.bind("mouseleave",e.onMouseLeaveVolume)),e.$on("destroy",e.onDestroy.bind(e))}}}]);