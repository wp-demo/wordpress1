!function(e,a){"undefined"!=typeof module&&module.exports?("undefined"==typeof angular?a(require("angular")):a(angular),module.exports="ngDialog"):"function"==typeof define&&define.amd?define(["angular"],a):a(e.angular)}(this,function(O){"use strict";var e=O.module("ngDialog",[]),k=O.element,a=O.isDefined,o=(document.body||document.documentElement).style,r=a(o.animation)||a(o.WebkitAnimation)||a(o.MozAnimation)||a(o.MsAnimation)||a(o.OAnimation),s="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",n={html:!1,body:!1},F={},N=[],T=[],x=!1,P=!1,I=[],t="legacy",c="1.0.0+";return e.provider("ngDialog",function(){var A=this.defaults={className:"ngdialog-theme-default",appendClassName:"",disableAnimation:!1,plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,onOpenCallback:!1,overlay:!0,cache:!0,trapFocus:!0,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null,bodyClassName:"ngdialog-open",width:null,height:null};this.setForceHtmlReload=function(e){n.html=e||!1},this.setForceBodyReload=function(e){n.body=e||!1},this.setDefaults=function(e){O.extend(A,e)},this.setOpenOnePerName=function(e){P=e||!1};var S,E=0,w=0,B={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function(o,l,m,i,f,p,y,v,h,b){var D=[],C={onDocumentKeydown:function(e){27===e.keyCode&&$.close("$escape")},activate:function(e){e.data("$ngDialogOptions").trapFocus&&(e.on("keydown",C.onTrapFocusKeydown),D.body.on("keydown",C.onTrapFocusKeydown))},deactivate:function(e){e.off("keydown",C.onTrapFocusKeydown),D.body.off("keydown",C.onTrapFocusKeydown)},deactivateAll:function(e){O.forEach(e,function(e){var a=O.element(e);C.deactivate(a)})},setBodyPadding:function(e){var a=parseInt(D.body.css("padding-right")||0,10);D.body.css("padding-right",a+e+"px"),D.body.data("ng-dialog-original-padding",a),p.$broadcast("ngDialog.setPadding",e)},resetBodyPadding:function(){var e=D.body.data("ng-dialog-original-padding");e?D.body.css("padding-right",e+"px"):D.body.css("padding-right",""),p.$broadcast("ngDialog.setPadding",0)},performCloseDialog:function(e,a){var o=e.data("$ngDialogOptions"),n=e.attr("id"),t=F[n];if(C.deactivate(e),t){if(void 0!==v.Hammer){var l=t.hammerTime;l.off("tap",S),l.destroy&&l.destroy(),delete t.hammerTime}else e.unbind("click");1===w&&D.body.unbind("keydown",C.onDocumentKeydown),e.hasClass("ngdialog-closing")||(w-=1);var i=e.data("$ngDialogPreviousFocus");i&&i.focus&&i.focus(),p.$broadcast("ngDialog.closing",e,a),w=w<0?0:w,r&&!o.disableAnimation?(t.$destroy(),e.unbind(s).bind(s,function(){C.closeDialogElement(e,a)}).addClass("ngdialog-closing")):(t.$destroy(),C.closeDialogElement(e,a)),B[n]&&(B[n].resolve({id:n,value:a,$dialog:e,remainingDialogs:w}),delete B[n]),F[n]&&delete F[n],N.splice(N.indexOf(n),1),N.length||(D.body.unbind("keydown",C.onDocumentKeydown),x=!1),0==w&&(S=void 0)}},closeDialogElement:function(e,a){var o=e.data("$ngDialogOptions");e.remove(),T.splice(T.indexOf(o.bodyClassName),1),-1===T.indexOf(o.bodyClassName)&&(D.html.removeClass(o.bodyClassName),D.body.removeClass(o.bodyClassName)),0===w&&C.resetBodyPadding(),p.$broadcast("ngDialog.closed",e,a)},closeDialog:function(e,a){var o=e.data("$ngDialogPreCloseCallback");if(o&&O.isFunction(o)){var n=o.call(e,a);if(O.isObject(n))n.closePromise?n.closePromise.then(function(){C.performCloseDialog(e,a)},function(){return!1}):n.then(function(){C.performCloseDialog(e,a)},function(){return!1});else{if(!1===n)return!1;C.performCloseDialog(e,a)}}else C.performCloseDialog(e,a)},onTrapFocusKeydown:function(e){var a,o=O.element(e.currentTarget);if(o.hasClass("ngdialog"))a=o;else if(null===(a=C.getActiveDialog()))return;var n=9===e.keyCode,t=!0===e.shiftKey;n&&C.handleTab(a,e,t)},handleTab:function(e,a,o){var n=C.getFocusableElements(e);if(0!==n.length){var t=document.activeElement,l=Array.prototype.indexOf.call(n,t),i=-1===l,r=0===l,s=l===n.length-1,c=!1;o?(i||r)&&(n[n.length-1].focus(),c=!0):(i||s)&&(n[0].focus(),c=!0),c&&(a.preventDefault(),a.stopPropagation())}else document.activeElement&&document.activeElement.blur&&document.activeElement.blur()},autoFocus:function(e){var a=e[0],o=a.querySelector("*[autofocus]");if(null===o||(o.focus(),document.activeElement!==o)){var n=C.getFocusableElements(e);if(0<n.length)n[0].focus();else{var t=C.filterVisibleElements(a.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));if(0<t.length){var l=t[0];k(l).attr("tabindex","-1").css("outline","0"),l.focus()}}}},getFocusableElements:function(e){var a=e[0].querySelectorAll("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]"),o=C.filterTabbableElements(a);return C.filterVisibleElements(o)},filterTabbableElements:function(e){for(var a=[],o=0;o<e.length;o++){var n=e[o];"-1"!==k(n).attr("tabindex")&&a.push(n)}return a},filterVisibleElements:function(e){for(var a=[],o=0;o<e.length;o++){var n=e[o];(0<n.offsetWidth||0<n.offsetHeight)&&a.push(n)}return a},getActiveDialog:function(){var e=document.querySelectorAll(".ngdialog");return 0===e.length?null:k(e[e.length-1])},applyAriaAttributes:function(e,a){if(a.ariaAuto){if(!a.ariaRole){var o=0<C.getFocusableElements(e).length?"dialog":"alertdialog";a.ariaRole=o}a.ariaLabelledBySelector||(a.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6"),a.ariaDescribedBySelector||(a.ariaDescribedBySelector="article,section,p")}a.ariaRole&&e.attr("role",a.ariaRole),C.applyAriaAttribute(e,"aria-labelledby",a.ariaLabelledById,a.ariaLabelledBySelector),C.applyAriaAttribute(e,"aria-describedby",a.ariaDescribedById,a.ariaDescribedBySelector)},applyAriaAttribute:function(e,a,o,n){if(o)e.attr(a,o);else if(n){var t=e.attr("id"),l=e[0].querySelector(n);if(!l)return;var i=t+"-"+a;return k(l).attr("id",i),e.attr(a,i),i}},detectUIRouter:function(){return b.has("$transitions")?c:!!b.has("$state")&&t},getRouterLocationEventName:function(){return C.detectUIRouter()?"$stateChangeStart":"$locationChangeStart"}},$={__PRIVATE__:C,open:function(e){var r=null;if(e=e||{},!(P&&e.name&&(r=e.name.toLowerCase().replace(/\s/g,"-")+"-dialog",this.isOpen(r)))){var a,s,c,d,g,u=O.copy(A),o=++E;r=r||"ngdialog"+o,N.push(r),void 0!==u.data&&(void 0===e.data&&(e.data={}),e.data=O.merge(O.copy(u.data),e.data)),O.extend(u,e),B[r]=a=i.defer(),F[r]=s=O.isObject(u.scope)?u.scope.$new():p.$new();var n=O.extend({},u.resolve);return O.forEach(n,function(e,a){n[a]=O.isString(e)?b.get(e):b.invoke(e,null,null,a)}),i.all({template:function(e){if(!e)return"Empty template";if(O.isString(e)&&u.plain)return e;return"boolean"!=typeof u.cache||u.cache?t(e,{cache:l}):t(e,{cache:!1})}(u.template||u.templateUrl),locals:i.all(n)}).then(function(e){var a=e.template,o=e.locals;u.showClose&&(a+='<button aria-label="Dismiss" class="ngdialog-close"></button>');var n=u.overlay?"":" ngdialog-no-overlay";if((c=k('<div id="'+r+'" class="ngdialog'+n+'"></div>')).html(u.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content" role="document">'+a+"</div>":'<div class="ngdialog-content" role="document">'+a+"</div>"),c.data("$ngDialogOptions",u),s.ngDialogId=r,u.data&&O.isString(u.data)){var t=u.data.replace(/^\s*/,"")[0];s.ngDialogData="{"===t||"["===t?O.fromJson(u.data):new String(u.data),s.ngDialogData.ngDialogId=r}else u.data&&O.isObject(u.data)&&(s.ngDialogData=u.data,s.ngDialogData.ngDialogId=r);if(u.className&&c.addClass(u.className),u.appendClassName&&c.addClass(u.appendClassName),u.width&&(g=c[0].querySelector(".ngdialog-content"),O.isString(u.width)?g.style.width=u.width:g.style.width=u.width+"px"),u.height&&(g=c[0].querySelector(".ngdialog-content"),O.isString(u.height)?g.style.height=u.height:g.style.height=u.height+"px"),u.disableAnimation&&c.addClass("ngdialog-disabled-animation"),d=u.appendTo&&O.isString(u.appendTo)?O.element(document.querySelector(u.appendTo)):D.body,C.applyAriaAttributes(c,u),[{name:"$ngDialogPreCloseCallback",value:u.preCloseCallback},{name:"$ngDialogOnOpenCallback",value:u.onOpenCallback}].forEach(function(e){var a;e.value&&(O.isFunction(e.value)?a=e.value:O.isString(e.value)&&s&&(O.isFunction(s[e.value])?a=s[e.value]:s.$parent&&O.isFunction(s.$parent[e.value])?a=s.$parent[e.value]:p&&O.isFunction(p[e.value])&&(a=p[e.value])),a&&c.data(e.name,a))}),s.closeThisDialog=function(e){C.closeDialog(c,e)},u.controller&&(O.isString(u.controller)||O.isArray(u.controller)||O.isFunction(u.controller))){var l;u.controllerAs&&O.isString(u.controllerAs)&&(l=u.controllerAs);var i=h(u.controller,O.extend(o,{$scope:s,$element:c}),!0,l);u.bindToController&&O.extend(i.instance,{ngDialogId:s.ngDialogId,ngDialogData:s.ngDialogData,closeThisDialog:s.closeThisDialog,confirm:s.confirm}),"function"==typeof i?c.data("$ngDialogControllerController",i()):c.data("$ngDialogControllerController",i)}(y(function(){var e=document.querySelectorAll(".ngdialog");C.deactivateAll(e),m(c)(s);var a=v.innerWidth-D.body.prop("clientWidth");D.html.addClass(u.bodyClassName),D.body.addClass(u.bodyClassName),T.push(u.bodyClassName);var o=a-(v.innerWidth-D.body.prop("clientWidth"));0<o&&C.setBodyPadding(o),d.append(c),C.activate(c),u.trapFocus&&C.autoFocus(c),u.name?p.$broadcast("ngDialog.opened",{dialog:c,name:u.name}):p.$broadcast("ngDialog.opened",c);var n=c.data("$ngDialogOnOpenCallback");n&&O.isFunction(n)&&n.call(c)}),x||(D.body.bind("keydown",C.onDocumentKeydown),x=!0),u.closeByNavigation&&I.push(c),u.preserveFocus&&c.data("$ngDialogPreviousFocus",document.activeElement),S=function(e){var a=!!u.closeByDocument&&k(e.target).hasClass("ngdialog-overlay"),o=k(e.target).hasClass("ngdialog-close");(a||o)&&$.close(c.attr("id"),o?"$closeButton":"$document")},void 0!==v.Hammer)?(s.hammerTime=v.Hammer(c[0])).on("tap",S):c.bind("click",S);return w+=1,$}),{id:r,closePromise:a.promise,close:function(e){C.closeDialog(c,e)}}}function t(a,e){return(e=e||{}).headers=e.headers||{},O.extend(e.headers,{Accept:"text/html"}),p.$broadcast("ngDialog.templateLoading",a),f.get(a,e).then(function(e){return p.$broadcast("ngDialog.templateLoaded",a),e.data||""})}},openConfirm:function(e){var o=i.defer(),a=O.copy(A);e=e||{},void 0!==a.data&&(void 0===e.data&&(e.data={}),e.data=O.merge(O.copy(a.data),e.data)),O.extend(a,e),a.scope=O.isObject(a.scope)?a.scope.$new():p.$new(),a.scope.confirm=function(e){o.resolve(e);var a=k(document.getElementById(n.id));C.performCloseDialog(a,e)};var n=$.open(a);if(n)return n.closePromise.then(function(e){return e?o.reject(e.value):o.reject()}),o.promise},isOpen:function(e){return 0<k(document.getElementById(e)).length},close:function(e,a){var o=k(document.getElementById(e));if(o.length)C.closeDialog(o,a);else if("$escape"===e){var n=N[N.length-1];(o=k(document.getElementById(n))).data("$ngDialogOptions").closeByEscape&&C.closeDialog(o,"$escape")}else $.closeAll(a);return $},closeAll:function(e){for(var a=document.querySelectorAll(".ngdialog"),o=a.length-1;0<=o;o--){var n=a[o];C.closeDialog(k(n),e)}},getOpenDialogs:function(){return N},getDefaults:function(){return A}};O.forEach(["html","body"],function(e){if(D[e]=o.find(e),n[e]){var a=C.getRouterLocationEventName();p.$on(a,function(){D[e]=o.find(e)})}});var e=C.detectUIRouter();if(e===c){b.get("$transitions").onStart({},function(e){for(;0<I.length;){var a=I.pop();if(!1===C.closeDialog(a))return!1}})}else{var a=e===t?"$stateChangeStart":"$locationChangeStart";p.$on(a,function(e){for(;0<I.length;){var a=I.pop();!1===C.closeDialog(a)&&e.preventDefault()}})}return $}]}),e.directive("ngDialog",["ngDialog",function(l){return{restrict:"A",scope:{ngDialogScope:"="},link:function(n,e,t){e.on("click",function(e){e.preventDefault();var a=O.isDefined(n.ngDialogScope)?n.ngDialogScope:"noScope";O.isDefined(t.ngDialogClosePrevious)&&l.close(t.ngDialogClosePrevious);var o=l.getDefaults();l.open({template:t.ngDialog,className:t.ngDialogClass||o.className,appendClassName:t.ngDialogAppendClass,controller:t.ngDialogController,controllerAs:t.ngDialogControllerAs,bindToController:t.ngDialogBindToController,disableAnimation:t.ngDialogDisableAnimation,scope:a,data:t.ngDialogData,showClose:"false"!==t.ngDialogShowClose&&("true"===t.ngDialogShowClose||o.showClose),closeByDocument:"false"!==t.ngDialogCloseByDocument&&("true"===t.ngDialogCloseByDocument||o.closeByDocument),closeByEscape:"false"!==t.ngDialogCloseByEscape&&("true"===t.ngDialogCloseByEscape||o.closeByEscape),overlay:"false"!==t.ngDialogOverlay&&("true"===t.ngDialogOverlay||o.overlay),preCloseCallback:t.ngDialogPreCloseCallback||o.preCloseCallback,onOpenCallback:t.ngDialogOnOpenCallback||o.onOpenCallback,bodyClassName:t.ngDialogBodyClass||o.bodyClassName})})}}}]),e});