!function(L){"use strict";L.module("ngLocationSearch",[]).directive("ngLocationSearch",["$rootScope","$log","$timeout","$location","$window","$parse","$httpParamSerializer",function(S,n,d,v,m,f,p){return{restrict:"A",require:["?ngModel","?^form"],link:function(u,n,o,a){var i,r=o.ngLocationSearchDefault?u.$eval(o.ngLocationSearchDefault):null,t=a[0],e=a[1];function $(n){return!!L.isString(n)&&n.replace(/\/$/,"")}function c(t){var l={},s=u.$eval(o.ngLocationSearchReplace),n=u.$eval(o.ngLocationSearchReset),h=$(o.ngLocationSearchUrl),f=$(m.location.href.replace(m.location.hash,"")),a=o.ngLocationSearchDelay||0;try{var e=L.fromJson(t);t=e}catch(n){}L.forEach(i,function(n,a){var e=r;L.isObject(t)&&L.isDefined(t[n])?e=t[n]:L.isString(t)&&(e=t),l[n]=e&&""!==e?e.toString():r});var g=v.search();n||(l=L.extend({},g,l)),L.equals(l,g)||(S.$broadcast("ngLocationSearchChangeStart",l,g),d(function(){if(L.isString(h)&&h!==f){var n=0!==h.indexOf("/"),a=-1!==h.indexOf("#!/")||-1!==h.indexOf("#/"),e=0===h.indexOf(v.protocol()),t=v.path(),o=$(m.location.hash.replace(v.url(),"")),i=p(l),r="";if(!v.$$html5||e)r=h+(i=i?"?"+i:""),!a&&e&&(t=t&&!v.$$html5?"/":"",r=h+o+t+i),m.location.href=r,v.search(l);else{if(v.search(i),s&&u.$apply(),n){var c=t.split("/");r=c[c.length-1]===h?t:t+"/"+h}else r=h;v.path(r),u.$apply()}}else v.search(l);S.$broadcast("ngLocationSearchChangeSuccess",l,g)},parseInt(a,10)))}if(o.ngLocationSearch&&(t||e)){i=u.$eval(o.ngLocationSearch),i=L.isArray(i)?i:[o.ngLocationSearch];var l=r,s=function(e){l=1<i.length?{}:r,L.forEach(i,function(n,a){L.isObject(l)?l[n]=L.isDefined(e[n])?e[n]:r:L.isDefined(e[n])&&(l=e[n])}),L.isObject(l)&&(l=L.toJson(l)),(0,f(o.ngModel).assign)(u,l)},h=function(e){if(0<i.length){var n=u.$eval(o.ngSubmit);l={},L.forEach(i,function(n,a){L.isDefined(e[n])&&(l[n]=e[n])}),n=L.isObject(n)?n:{},l=L.extend(n,l),(0,f(o.ngSubmit).assign)(u,l)}};t&&(u.$watch(function(){return t.$modelValue},function(n,a){if(n!==a&&t.$valid)c(n);else{var e=o.name;S.$broadcast("ngLocationSearchChangeError","model",e,t)}}),u.$on("$locationChangeStart",function(n,a,e,t,o){s(v.search())}),s(v.search())),e&&(n.on("submit",function(){var n=u.$eval(o.ngSubmit),a=o.name,e=u.$eval(a);!n||e&&!e.$valid?S.$broadcast("ngLocationSearchChangeError","form",a,e):c(n)}),u.$on("$locationChangeStart",function(n,a,e,t,o){h(v.search())}),h(v.search()))}u.$on("$destroy",function(){L.isDefined(u[o.ngSubmit])&&delete u[o.ngSubmit]})}}}])}(window.angular);