!function(){"use strict";angular.module("ngMagnify",[]).directive("ngMagnify",[function(){return{restrict:"EA",replace:!0,template:'<div class="magnify-container" data-ng-style="getContainerStyle()"><div class="magnify-glass" data-ng-style="getGlassStyle()"></div><img class="magnify-image" data-ng-src="{{ imageSrc }}"/></div>',scope:{imageSrc:"@",imageWidth:"=",imageHeight:"=",glassWidth:"=",glassHeight:"="},link:function(n,e){var s,o,h,i,c=e.find("div"),a=e.find("img");"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||(e.on("mousemove",function(t){s=angular.extend(n.getOffset(e[0]),{width:e[0].offsetWidth,height:e[0].offsetHeight,imageWidth:a[0].offsetWidth,imageHeight:a[0].offsetHeight,glassWidth:c[0].offsetWidth,glassHeight:c[0].offsetHeight}),(i=n.magnify(t))&&c.css(i)}).on("mouseleave",function(){c.css({opacity:0,filter:"alpha(opacity=0)"}),h=o=void 0}),n.magnify=function(t){var e,i,a,g;if(o||h)return e=t.pageX?t.pageX-s.left:t.x,i=t.pageY?t.pageY-s.top:t.y,e<s.width&&i<s.height&&0<e&&0<i?(c.css({opacity:1,"z-index":1,filter:"alpha(opacity=100)"}),a=-1*Math.round(e/s.imageWidth*o-s.glassWidth/2)+"px "+-1*Math.round(i/s.imageHeight*h-s.glassHeight/2)+"px",{left:e-s.glassWidth/2+"px",top:i-s.glassHeight/2+"px",backgroundPosition:a}):void c.css({opacity:0,"z-index":-1,filter:"alpha(opacity=0)"});(g=new Image).onload=function(){o=g.width,h=g.height},g.src=n.imageSrc},n.getOffset=function(t){var e=document.documentElement,i=t.getBoundingClientRect();return{top:i.top+window.pageYOffset-e.clientTop,left:i.left+window.pageXOffset-e.clientLeft}},n.getContainerStyle=function(){return{width:n.imageWidth?n.imageWidth+"px":"",height:n.imageHeight?n.imageHeight+"px":""}},n.getGlassStyle=function(){return{background:'url("'+n.imageSrc+'") no-repeat',width:n.glassWidth?n.glassWidth+"px":"",height:n.glassHeight?n.glassHeight+"px":""}})}}}])}();