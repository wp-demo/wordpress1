{"version":3,"sources":["galleria.history.js"],"names":["$","window","Galleria","requires","History","onloads","init","loc","location","doc","document","ie","IE","support","mode","undefined","iframe","get","winloc","parseInt","hash","substr","saved","callbacks","onchange","each","i","fn","call","ready","setHash","val","interval","setInterval","isNaN","hide","attr","one","this","contentWindow","insertAfter","body","change","push","onhashchange","set","idoc","open","close","jQuery"],"mappings":"CAUC,SAAUA,GAAGC;IAIdC,SAASC,SAAS,MAAM;IAExBD,SAASE,UAAW;QAEhB,IAAIC,UAAU,IAEVC,OAAO,OAEPC,MAAMN,OAAOO,UAEbC,MAAMR,OAAOS,UAEbC,KAAKT,SAASU,IAEdC,UAAU,kBAAkBZ,WAAYQ,IAAIK,SAASC,aAAaN,IAAIK,OAAO,IAE7EE,QAEAC,MAAM,SAAUC;YACZ,IAAIF,WAAWH,WAAWX,SAASU,IAAK;gBACpCM,SAASA,UAAUF,OAAOR;mBACtB;gBACJU,SAASX;;YAEb,OAAOY,SAAUD,OAAOE,KAAKC,OAAO,IAAI;WAG5CC,QAAQL,IAAKV,MAEbgB,YAAY,IAEZC,WAAW;YACPxB,EAAEyB,KAAMF,WAAW,SAAUG,GAAGC;gBAC5BA,GAAGC,KAAM3B,QAAQgB;;WAIzBY,QAAQ;YACJ7B,EAAEyB,KAAMpB,SAAS,SAASqB,GAAGC;gBACzBA;;YAGJrB,OAAO;WAGXwB,UAAU,SAAUC;YAChB,OAAO,MAAMA;;QAIrB,IAAKlB,WAAWF,KAAK,GAAI;YACrBE,UAAU;;QAGd,KAAMA,SAAU;YAEZb,EAAE;gBAEE,IAAIgC,WAAW/B,OAAOgC,YAAY;oBAE9B,IAAIb,OAAOH;oBAEX,KAAMiB,MAAOd,SAAUA,QAAQE,OAAQ;wBACnCA,QAAQF;wBACRb,IAAIa,OAAOU,QAASV;wBACpBI;;mBAGL;gBAEH,IAAKb,IAAK;oBAENX,EAAE,wCAAwCmC,OAAOC,KAAM,OAAO,eAAgBC,IAAI,QAAQ;wBAEtFrB,SAASsB,KAAKC;wBAEdV;uBAEDW,YAAY/B,IAAIgC;uBAEhB;oBACHZ;;;eAGL;YACHA;;QAGJ,OAAO;YAEHa,QAAQ,SAAUf;gBAEdJ,UAAUoB,KAAMhB;gBAEhB,IAAId,SAAU;oBACVZ,OAAO2C,eAAepB;;;YAI9BqB,KAAK,SAAUd;gBAEX,IAAKG,MAAOH,MAAQ;oBAChB;;gBAGJ,KAAMlB,WAAWF,IAAK;oBAElB2B,KAAKT,MAAM;wBAEP,IAAIiB,OAAO9B,OAAON;wBAClBoC,KAAKC;wBACLD,KAAKE;wBAELhC,OAAOR,SAASY,OAAOU,QAASC;;;gBAKxCxB,IAAIa,OAAOU,QAASC;;YAGxBF,OAAO,SAASF;gBACZ,KAAKrB,MAAM;oBACPD,QAAQsC,KAAKhB;uBACV;oBACHA;;;;KA3HP;EANT,CAuIGsB,QAAQX","file":"galleria.history.js","sourcesContent":["/**\n * Galleria History Plugin 2016-09-03\n * http://galleria.io\n *\n * Copyright (c) 2010 - 2017 worse is better UG\n * Licensed under the MIT license\n * https://raw.github.com/worseisbetter/galleria/master/LICENSE\n *\n */\n\n(function( $, window ) {\n\n/*global jQuery, Galleria, window */\n\nGalleria.requires(1.25, 'The History Plugin requires Galleria version 1.2.5 or later.');\n\nGalleria.History = (function() {\n\n    var onloads = [],\n\n        init = false,\n\n        loc = window.location,\n\n        doc = window.document,\n\n        ie = Galleria.IE,\n\n        support = 'onhashchange' in window && ( doc.mode === undefined || doc.mode > 7 ),\n\n        iframe,\n\n        get = function( winloc ) {\n            if( iframe && !support && Galleria.IE ) {\n                winloc = winloc || iframe.location;\n            }  else {\n                winloc = loc;\n            }\n            return parseInt( winloc.hash.substr(2), 10 );\n        },\n\n        saved = get( loc ),\n\n        callbacks = [],\n\n        onchange = function() {\n            $.each( callbacks, function( i, fn ) {\n                fn.call( window, get() );\n            });\n        },\n\n        ready = function() {\n            $.each( onloads, function(i, fn) {\n                fn();\n            });\n\n            init = true;\n        },\n\n        setHash = function( val ) {\n            return '/' + val;\n        };\n\n    // always remove support if IE < 8\n    if ( support && ie < 8 ) {\n        support = false;\n    }\n\n    if ( !support ) {\n\n        $(function() {\n\n            var interval = window.setInterval(function() {\n\n                var hash = get();\n\n                if ( !isNaN( hash ) && hash != saved ) {\n                    saved = hash;\n                    loc.hash = setHash( hash );\n                    onchange();\n                }\n\n            }, 50);\n\n            if ( ie ) {\n\n                $('<iframe tabindex=\"-1\" title=\"empty\">').hide().attr( 'src', 'about:blank' ).one('load', function() {\n\n                    iframe = this.contentWindow;\n\n                    ready();\n\n                }).insertAfter(doc.body);\n\n            } else {\n                ready();\n            }\n        });\n    } else {\n        ready();\n    }\n\n    return {\n\n        change: function( fn ) {\n\n            callbacks.push( fn );\n\n            if( support ) {\n                window.onhashchange = onchange;\n            }\n        },\n\n        set: function( val ) {\n\n            if ( isNaN( val ) ) {\n                return;\n            }\n\n            if ( !support && ie ) {\n\n                this.ready(function() {\n\n                    var idoc = iframe.document;\n                    idoc.open();\n                    idoc.close();\n\n                    iframe.location.hash = setHash( val );\n\n                });\n            }\n\n            loc.hash = setHash( val );\n        },\n\n        ready: function(fn) {\n            if (!init) {\n                onloads.push(fn);\n            } else {\n                fn();\n            }\n        }\n    };\n}());\n\n}( jQuery, this ));\n\n"],"sourceRoot":"scripts/"}