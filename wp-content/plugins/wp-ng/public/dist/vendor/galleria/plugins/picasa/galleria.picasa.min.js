!function(n){Galleria.requires(1.25,"The Picasa Plugin requires Galleria version 1.2.5 or later.");var o=Galleria.utils.getScriptPath();Galleria.Picasa=function(){this.options={max:30,imageSize:"medium",thumbSize:"thumb",complete:function(){}}},Galleria.Picasa.prototype={constructor:Galleria.Picasa,search:function(i,t){return this._call("search","all",{q:i},t)},user:function(i,t){return this._call("user","user/"+i,t)},useralbum:function(i,t,a){return this._call("useralbum","user/"+i+"/album/"+t,a)},setOptions:function(i){return n.extend(this.options,i),this},_call:function(t,a,i,e){a="https://picasaweb.google.com/data/feed/api/"+a+"?","function"==typeof i&&(e=i,i={});var r=this;i=n.extend({kind:"photo",access:"public","max-results":this.options.max,thumbsize:this._getSizes().join(","),alt:"json-in-script",callback:"?"},i),n.each(i,function(i,t){a+="&"+i+"="+t});var s=!1;return Galleria.utils.wait({until:function(){return s},success:function(){r._parse.call(r,s.feed.entry,e)},error:function(){var i="";"user"==t?i="user not found.":"useralbum"==t&&(i="album or user not found."),Galleria.raise("Picasa request failed"+(i?": "+i:"."))},timeout:5e3}),n.getJSON(a,function(i){s=i}),r},_getSizes:function(){var t,i={small:"72c",thumb:"104u",medium:"640u",big:"1024u",original:"1600u"},a=this.options,e={},r=[32,48,64,72,94,104,110,128,144,150,160,200,220,288,320,400,512,576,640,720,800,912,1024,1152,1280,1440,1600];return n(["thumbSize","imageSize"]).each(function(){a[this]in i?e[this]=i[a[this]]:(1600<(t=Galleria.utils.parseValue(a[this]))?t=1600:n.each(r,function(i){if(t<this)return t=r[i-1],!1}),e[this]=t)}),[e.thumbSize,e.imageSize,"1280u"]},_parse:function(i,t){var a,e=[];n.each(i,function(){a=this.media$group.media$thumbnail,e.push({thumb:a[0].url,image:a[1].url,big:a[2].url,title:this.summary.$t})}),t.call(this,e)}};var u=Galleria.prototype.load;Galleria.prototype.load=function(){if(arguments.length||"string"!=typeof this._options.picasa)u.apply(this,Galleria.utils.array(arguments));else{var t,a=this,i=Galleria.utils.array(arguments),e=this._options.picasa.split(":"),r=n.extend({},a._options.picasaOptions),s=void 0!==r.loader?r.loader:n("<div>").css({width:48,height:48,opacity:.7,background:"#000 url("+o+"loader.gif) no-repeat 50% 50%"});if(e.length){if("function"!=typeof Galleria.Picasa.prototype[e[0]])return Galleria.raise(e[0]+" method not found in Picasa plugin"),u.apply(this,i);if(!e[1])return Galleria.raise("No picasa argument found"),u.apply(this,i);window.setTimeout(function(){a.$("target").append(s)},100),t=new Galleria.Picasa,"object"==typeof a._options.picasaOptions&&t.setOptions(a._options.picasaOptions);var l=[];if("useralbum"==e[0]){if(2!=(l=e[1].split("/")).length)return void Galleria.raise("Picasa useralbum not correctly formatted (should be [user]/[album])")}else l.push(e[1]);l.push(function(i){a._data=i,s.remove(),a.trigger(Galleria.DATA),t.options.complete.call(t,i)}),t[e[0]].apply(t,l)}else u.apply(this,i)}}}(jQuery);